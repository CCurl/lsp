#include <stdio.h>

void outC(int c) { putc(c,stdout); }

void emit(int n, char *str) {
    int i = 0;
    while (n) {
        outC(str[i]);
        i = i+1;
        n = n-1;
    }
}

int main() {
    // ELF header
    emit(16, "\x7f\x45\x4c\x46\x01\x01\x01\x00\x00\x00\x00\x00\x00\x00\x00\x00");
    emit(16, "\x02\x00\x03\x00\x01\x00\x00\x00\x54\x80\x04\x08\x34\x00\x00\x00");
    emit(16, "\x00\x00\x00\x00\x00\x00\x00\x00\x34\x00\x20\x00\x01\x00\x00\x00");
    emit(16, "\x00\x00\x00\x00\x01\x00\x00\x00\x00\x00\x00\x00\x00\x80\x04\x08");
    emit(16, "\x00\x80\x04\x08\x10\x4b\x00\x00\x10\x4b\x00\x00\x07\x00\x00\x00");
    emit(16, "\x00\x10\x00\x00\xe8\x00\x00\x00\x00\x89\xc3\x31\xc0\x40\xcd\x80");

    emit(5, "\xb8\x78\x78\x78\x78");
 
    // WRITE - EAX=$04, EBX=<nchars>, ECX=<buf>, EDX=<sz>
    emit(5, "\xb8\x04\x00\x00\x00"); // MOV eax,$04 (write)
    emit(5, "\xbb\x01\x00\x00\x00"); // MOV ebx,$01
    emit(2, "\xcd\x80");             // INT $80
    
    // exit - EAX=$01, EBX=<code>
    emit(5, "\xb8\x01\x00\x00\x00"); // MOV eax,$01 (exit)
    emit(5, "\xbb\x00\x0a\x00\x00"); // MOV ebx,$10
    emit(2, "\xcd\x80");             // INT $80
 
    emit(5, "\xb8\x78\x78\x78\x78");
}
# A minimal and simple compiler for a FASM-based tool chain.
TC is a minimal compiler that supports a C-like syntax.<br/>
Its initial purpose was to be a pedagogical tool for learning about compilers.<br/>
It has morphed into a serious attempt at a minimal but useful full-fledged compiler.<br/>
The compiler currently does a minimal amount of error checking.<br/>
It generates assembly code for the FASM assembler.<br/>

## How it works
Since TC generates assembly code for FASM, forward branches are not a problem.<br/>
TC breaks the input stream into a stream of tokens.<br/>
The current token is associated with some code.<br/>
That code can look at the next token (if necessary) and decide what to do next.<br/>

### Grammar
The grammar of language in EBNF is below.<br/>
NOTE: I am not very familiar with EBNF, so this may not be 100% accurate.

```
  <program>    ::= <defs>
  <defs>       ::= <defs> <def> | <def>
  <def>        ::= <func_def> | <int-def> | <char-def>
  <func-def>   ::= "void" <id> "()" "{" <statements> "}" |
  <int-def>    ::= "int" <id> ";" | "int" <id> "[" <num> "]" ";"
  <char-def>   ::= "char" <id> ";" | "char" <id> "[" <num> "]" ";"
  <statements> ::= <statements> <statement> | <statement> | <nothing>
  <statement>  ::= "if" <paren_expr> <statement> |
                   "if" <paren_expr> <statement> "else" <statement> |
                   "while" <paren_expr> <statement> |
                   "{" <statements> "}" |
                   <func-call> ";" |
                   "return" <expr> ";" | "return" ";" |
                   <id> "=" <expr> ";" |
                   <id> "[" <expr> "]" "=" <expr> ";" | (future)
                   <id> "++" ";" |
                   <id> "--" ";" |
                   <id> "+=" <expr> ";" |
                   "//" |
                   ";"
  <func-call>  ::= <id> "(" ")"
  <expr>       ::= <term> | <term> <op> <term>
  <term>       ::= <id> | <num> | <string> | <paren_expr>
  <id>         ::= <alpha><alpha-numeric>*
  <num>        ::= [0-9]*
  <string>     ::= '"' <chars> '"'
  <op>         ::= <math-op> | <test-op> | <bin-op>
  <math-op>    ::= one of (+ - * /)
  <test-op>    ::= one of (< == > !=)
  <bin-op>     ::= one of (& | ^)
  <paren_expr> ::= "(" <expr> ")"
  <nothing>    ::= 
 ```

It is broken into multiple parts
- each part is implemented in a single file.

tc.c: the tiny-c compiler
- This takes a source file as the only argument.
- If no argument is given, it reads the source from STDIN.
- The output is written to STDOUT.
- This is a assembly file that can be assembled by FASM.
- Any fatal errors are written to STDERR.

hex-dump.c: A little program to dump a file's contents in hex.

vm.c: an x86/Linux emulator (in progress)
- This is a VM that emulates an extremely stripped down Linux/x86 system.
- Its purpose is to be able to debug the system without contantly causing crashes.
- It generates file 'vm.lst', a disassembly listing of the program.

Running:
```
make test 
make bm
```

TODO:
- [x] Update tc to generate FASM code that generates an executable.
- [i] Create a simple emulator (vm) that can run a useful subset of Linux.
- [i] Optimize the code generated by tc.c.
- [ ] Enhance tc to the point where it can build itself.
- [ ] 
